<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Properties of delay systems · ControlSystems.jl</title><meta name="title" content="Properties of delay systems · ControlSystems.jl"/><meta property="og:title" content="Properties of delay systems · ControlSystems.jl"/><meta property="twitter:title" content="Properties of delay systems · ControlSystems.jl"/><meta name="description" content="Documentation for ControlSystems.jl."/><meta property="og:description" content="Documentation for ControlSystems.jl."/><meta property="twitter:description" content="Documentation for ControlSystems.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ControlSystems.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ControlSystems.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introductory guide</span><ul><li><a class="tocitem" href="../../man/introduction/">Introduction</a></li><li><a class="tocitem" href="../../man/creating_systems/">Creating Systems</a></li><li><a class="tocitem" href="../../man/numerical/">Performance considerations</a></li><li><a class="tocitem" href="../../man/differences/">Noteworthy differences from other languages</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../example/">Design</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../smith_predictor/">Smith predictor</a></li><li><a class="tocitem" href="../ilc/">Iterative Learning Control (ILC)</a></li><li class="is-active"><a class="tocitem" href>Properties of delay systems</a><ul class="internal"><li><a class="tocitem" href="#Simulation-of-time-delay-systems"><span>Simulation of time-delay systems</span></a></li><li><a class="tocitem" href="#Estimation-of-delay"><span>Estimation of delay</span></a></li><li><a class="tocitem" href="#Approximation-and-discretization-of-delays"><span>Approximation and discretization of delays</span></a></li></ul></li><li><a class="tocitem" href="../automatic_differentiation/">Automatic differentiation</a></li><li><a class="tocitem" href="../tuning_from_data/">Tune a controller using experimental data</a></li><li><a class="tocitem" href="../zoh/">Analysis of sampled-data (continuous/discrete) systems</a></li></ul></li><li><span class="tocitem">Functions</span><ul><li><a class="tocitem" href="../../lib/constructors/">Constructors</a></li><li><a class="tocitem" href="../../lib/analysis/">Analysis</a></li><li><a class="tocitem" href="../../lib/synthesis/">Synthesis</a></li><li><a class="tocitem" href="../../lib/timefreqresponse/">Time and Frequency response</a></li><li><a class="tocitem" href="../../lib/plotting/">Plotting</a></li><li><a class="tocitem" href="../../lib/nonlinear/">Nonlinear</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Properties of delay systems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Properties of delay systems</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaControl/ControlSystems.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaControl/ControlSystems.jl/blob/master/docs/src/examples/delay_systems.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Properties-of-delay-systems"><a class="docs-heading-anchor" href="#Properties-of-delay-systems">Properties of delay systems</a><a id="Properties-of-delay-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Properties-of-delay-systems" title="Permalink"></a></h1><p>Delay systems can sometimes have non-intuitive properties, in particular when the delays appear inside of the system, i.e., not directly on the inputs or outputs. </p><p>The Nyquist plot of delay systems usually spirals towards the origin for delay systems. This is due to the phase loss at high frequencies due to the delay:</p><pre><code class="language-julia hljs">using ControlSystemsBase, Plots
w = exp10.(LinRange(-2, 2, 2000))
P = tf(1, [1, 1]) * delay(2) # Plant with delay on the input
nyquistplot(P, w)</code></pre><img src="f8e8b8ce.svg" alt="Example block output"/><p>When forming a feedback interconnection, making the delay appear in the closed loop, we may get gain ripple:</p><pre><code class="language-julia hljs">bodeplot(feedback(P), w)</code></pre><img src="3a162f0b.svg" alt="Example block output"/><p>If the system with delay has a direct feedthrough term, step responses may show repeated steps at integer multiples of the delay:</p><pre><code class="language-julia hljs">using ControlSystems # Load full control systems to get simulation functionality
P = tf([1, 1], [1, 0])*delay(1)
plot(step(feedback(P, 0.5), 0:0.001:20))</code></pre><img src="528bd27c.svg" alt="Example block output"/><p>Indeed, if the system has a non-zero feedthrough, the output will contain a delayed step attenuated by the feedthrough term, in this case</p><pre><code class="language-julia hljs">ss(feedback(tf([1, 1], [1, 0]))).D[]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.5</code></pre><p>the steps will thus in this case decay exponentially with decay rate 0.5. </p><p>For a more advanced example using time delays, see the <a href="../smith_predictor/#Smith-predictor">Smith predictor</a> tutorial.</p><h2 id="Simulation-of-time-delay-systems"><a class="docs-heading-anchor" href="#Simulation-of-time-delay-systems">Simulation of time-delay systems</a><a id="Simulation-of-time-delay-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-of-time-delay-systems" title="Permalink"></a></h2><p>Time-delay systems are numerically challenging to simulate, if you run into problems, please open an issue with a reproducing example. The <a href="../../lib/timefreqresponse/#ControlSystemsBase.lsim-Tuple{AbstractStateSpace, AbstractVecOrMat, AbstractVector}"><code>lsim</code></a>, <a href="../../lib/timefreqresponse/#Base.step-Tuple{AbstractStateSpace, AbstractVector}"><code>step</code></a> and <a href="../../lib/timefreqresponse/#ControlSystemsBase.impulse-Tuple{AbstractStateSpace, AbstractVector}"><code>impulse</code></a> functions accept keyword arguments that are passed along to the ODE integrator, this can be used to both select integration method and to tweak the integrator options. The documentation for solving delay-differential equations is available <a href="https://diffeq.sciml.ai/latest/types/dde_types/">here</a> and <a href="https://diffeq.sciml.ai/latest/tutorials/dde_example/">here</a>.</p><h2 id="Estimation-of-delay"><a class="docs-heading-anchor" href="#Estimation-of-delay">Estimation of delay</a><a id="Estimation-of-delay-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation-of-delay" title="Permalink"></a></h2><p>See the companion tutorial in ControlSystemIdentification.jl on <a href="https://baggepinnen.github.io/ControlSystemIdentification.jl/dev/examples/delayest/">Delay estimation</a>. This tutorial covers the both the detection of the presence of a delay, and estimation of models for systems with delays.</p><h2 id="Approximation-and-discretization-of-delays"><a class="docs-heading-anchor" href="#Approximation-and-discretization-of-delays">Approximation and discretization of delays</a><a id="Approximation-and-discretization-of-delays-1"></a><a class="docs-heading-anchor-permalink" href="#Approximation-and-discretization-of-delays" title="Permalink"></a></h2><p>Delay systems may be approximated as rational functions by means of <a href="https://en.wikipedia.org/wiki/Pad%C3%A9_approximant">Padé approximation</a> using the function <a href="../../lib/constructors/#ControlSystemsBase.pade"><code>pade</code></a>. Pure continuous-time delays can also be discretized using the function <a href="../../lib/constructors/#ControlSystemsBase.thiran"><code>thiran</code></a>. Continuous-time models with internal delays can be discretized using <a href="../../lib/constructors/#ControlSystemsBase.c2d"><code>c2d</code></a>, provided that the delay is an integer multiple of the sampling time (fractional delays are not yet supported by <a href="../../lib/constructors/#ControlSystemsBase.c2d"><code>c2d</code></a>).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ilc/">« Iterative Learning Control (ILC)</a><a class="docs-footer-nextpage" href="../automatic_differentiation/">Automatic differentiation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 26 August 2025 07:11">Tuesday 26 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
